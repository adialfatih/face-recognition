<% layout('layout') %>
    <style>
        /* HUD progress & REC dot (khusus halaman ini) */
        .fs-hud {
            position: fixed;
            left: 50%;
            top: 76px;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(10, 15, 32, .6);
            border: 1px solid #1f2a44;
            padding: 8px 14px;
            border-radius: 999px;
            backdrop-filter: saturate(140%) blur(2px);
            z-index: 12;
            box-shadow: 0 8px 20px rgba(0, 0, 0, .3)
        }

        .fs-hud .rec-dot {
            width: 10px;
            height: 10px;
            border-radius: 999px;
            background: #ef4444;
            box-shadow: 0 0 12px rgba(239, 68, 68, .9)
        }

        @keyframes recpulse {
            0% {
                transform: scale(1);
                opacity: .9
            }

            50% {
                transform: scale(1.25);
                opacity: .6
            }

            100% {
                transform: scale(1);
                opacity: .9
            }
        }

        .fs-hud .rec-dot.pulse {
            animation: recpulse 1s infinite
        }

        .fs-hud .rec-dot.ok {
            background: #16a34a;
            box-shadow: 0 0 12px rgba(34, 197, 94, .9);
            animation: none
        }

        /* In-page debug console (toggle dengan dblclick HUD) */
        .fs-debug {
            position: fixed;
            right: 10px;
            bottom: 10px;
            max-width: 60vw;
            max-height: 35vh;
            overflow: auto;
            background: rgba(0, 0, 0, .6);
            color: #fff;
            font: 12px/1.4 ui-monospace, Menlo, monospace;
            padding: 8px 10px;
            border-radius: 8px;
            z-index: 13;
            display: none
        }

        .fs-debug.show {
            display: block
        }
    </style>
    <div class="fullscreen">
        <div class="camfs">
            <video id="video" autoplay muted playsinline></video>
            <!-- penting: biar tombol bisa diklik di HP, canvas tidak menangkap touch -->
            <canvas id="overlay" style="pointer-events:none"></canvas>


            <!-- Floating HUD -->
            <div class="fs-hud" id="hud" aria-live="polite" title="Double-tap untuk toggle debug">
                <span class="rec-dot" id="recDot"></span>
                <span id="info">Siap merekam. Klik "Mulai Rekam".</span>
            </div>


            <div class="fs-controls">
                <button id="btnStart" class="pill">Mulai Rekam</button>
                <button id="btnSave" class="pill" style="display:none" disabled>Simpan</button>
            </div>


            <div id="debug" class="fs-debug"></div>
        </div>
    </div>
    <script>window.__NRP__ = '<%= nrp %>';</script>
    <script src="/public/js/face-common.js" defer></script>
    <script src="/public/js/rekam-capture.js" defer></script>