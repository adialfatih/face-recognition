<% layout('layout') %>
    <style>
        /* HUD progress & REC dot (khusus halaman ini) */
        .fs-hud {
            position: fixed;
            left: 50%;
            top: 76px;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 10px;
            background: rgba(10, 15, 32, .6);
            border: 1px solid #1f2a44;
            padding: 8px 14px;
            border-radius: 999px;
            backdrop-filter: saturate(140%) blur(2px);
            z-index: 12;
            box-shadow: 0 8px 20px rgba(0, 0, 0, .3);
            color: #fff;
        }

        .fs-hud .rec-dot {
            width: 10px;
            height: 10px;
            border-radius: 999px;
            background: #ef4444;
            box-shadow: 0 0 12px rgba(239, 68, 68, .9)
        }

        @keyframes recpulse {
            0% {
                transform: scale(1);
                opacity: .9
            }

            50% {
                transform: scale(1.25);
                opacity: .6
            }

            100% {
                transform: scale(1);
                opacity: .9
            }
        }

        .fs-hud .rec-dot.pulse {
            animation: recpulse 1s infinite
        }

        .fs-hud .rec-dot.ok {
            background: #16a34a;
            box-shadow: 0 0 12px rgba(34, 197, 94, .9);
            animation: none
        }
    </style>
    <div class="fullscreen">
        <div class="camfs">
            <!-- ganti elemen video jadi: -->
            <video id="video" autoplay muted playsinline
                style="position:absolute;left:0;top:0;z-index:1;width:100vw;height:100svh;height:100vh;object-fit:cover;"></video>


            <canvas id="overlay"
                style="position:absolute;left:0;top:0;z-index:2;pointer-events:none;transform:translateZ(0);"></canvas>


            <!-- Floating HUD -->
            <div class="fs-hud" id="hud" aria-live="polite" title="Double-tap untuk toggle debug">
                <span class="rec-dot" id="recDot"></span>
                <span id="info">Siap merekam. Klik "Mulai Rekam".</span>
            </div>


            <div class="fs-controls">
                <button id="btnStart" class="pill">Mulai Rekam</button>
                <button id="btnSave" class="pill" style="display:none" disabled>Simpan</button>
            </div>


        </div>
    </div>
    <script>window.__NRP__ = '<%= nrp %>';</script>
    <script src="/public/js/face-common.js" defer></script>
    <script src="/public/js/rekam-capture.js" defer></script>